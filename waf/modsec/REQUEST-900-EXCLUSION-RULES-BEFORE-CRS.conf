# /auth/google: silence LFI/RFI on ?scope=...
SecRule REQUEST_URI "@beginsWith /auth/google" \
    "id:1000101, phase:1, pass, nolog, t:none, \
    ctl:ruleRemoveTargetById=930120;ARGS:scope, \
    ctl:ruleRemoveTargetById=931130;ARGS:scope"

# OAuth callbacks: relax only typical params
SecRule REQUEST_URI "@rx ^/(auth/google/callback|oauth2callback|api/auth/callback/google)(?:\\?.*)?$" \
    "id:1000102, phase:1, pass, nolog, t:none, \
    ctl:paranoiaLevel=1, \
    ctl:ruleRemoveTargetById=941100;ARGS:state, \
    ctl:ruleRemoveTargetById=942100;ARGS:state, \
    ctl:ruleRemoveTargetById=941100;ARGS:code, \
    ctl:ruleRemoveTargetById=942100;ARGS:code, \
    ctl:ruleRemoveTargetById=941100;ARGS:id_token, \
    ctl:ruleRemoveTargetById=942100;ARGS:id_token, \
    ctl:ruleRemoveTargetById=941100;ARGS:credential, \
    ctl:ruleRemoveTargetById=942100;ARGS:credential"

# Static assets: stop Referer-based LFI noise only
SecRule REQUEST_URI "@rx ^/(favicon\\.ico|images/.*|css/.*|js/.*)$" \
    "id:1000103, phase:1, pass, nolog, t:none, \
    ctl:ruleRemoveTargetById=930121;REQUEST_HEADERS:Referer"
